# 分类

**刚性事务**完全遵守ACID规范

**柔性事务**：为了满足可用性、性能与降级服务的需要，降低一致性和隔离性的要求，遵循BASE理论：基本业务可用性，柔性状态，最终一致性。

柔性事务部分遵循ACID：

- 原子性（严格遵循）

- 一致性：最终一致性

- 隔离性：并行事务之间不可影响；事务中间结果可见性允许安全放宽

- 持久性：严格遵循

# 模型

1. 2PC
   
   第一阶段通知各个事务涉及到的参与者设备，如果都准备好了就进入第二阶段，如果返回NO则参与者们回滚，如果因为网络问题出现分区，则会出现死锁。

2. 3PC
   
   相比于2PC增加了超时机制以及资源锁定预留阶段，解决了2PC的阻塞问题，但是增加了latency，并且依然存在数据不一致的问题

3. TCC
   
   2PC的一种特化实现，Percolator也是2PC的一种特化实现。2PC的实现会与具体系统关联性较强，对内高内聚，对外低耦合。而TCC设计上讲究让业务做更多，业务可以做决策。

4. 基于MQ的方式就是消息表的一种具体特化实现，是异步的，不遵循ACID，而遵循BASE，讲究最终一致性，某些case下的弱一致性。通过MQ去做解耦，并利用MQ的可靠性等机制简化实现

# 什么是分布式事务？

为什么有了分布式一致性协议还要搞分布式事务？

分布式协议保证的是某一数据实体的多副本之间的一致性；

事务保证的是不同数据实体之间关系的一致性
